{"filter":false,"title":"index.js","tooltip":"/routes/index.js","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":81,"column":10},"end":{"row":81,"column":11},"action":"insert","lines":["m"],"id":4345}],[{"start":{"row":81,"column":11},"end":{"row":81,"column":12},"action":"insert","lines":["m"],"id":4346}],[{"start":{"row":81,"column":12},"end":{"row":81,"column":13},"action":"insert","lines":["e"],"id":4347}],[{"start":{"row":81,"column":13},"end":{"row":81,"column":14},"action":"insert","lines":["n"],"id":4348}],[{"start":{"row":81,"column":14},"end":{"row":81,"column":15},"action":"insert","lines":["t"],"id":4349}],[{"start":{"row":81,"column":15},"end":{"row":81,"column":16},"action":"insert","lines":[" "],"id":4350}],[{"start":{"row":81,"column":16},"end":{"row":81,"column":17},"action":"insert","lines":["*"],"id":4351}],[{"start":{"row":81,"column":17},"end":{"row":81,"column":18},"action":"insert","lines":["/"],"id":4352}],[{"start":{"row":81,"column":18},"end":{"row":82,"column":0},"action":"insert","lines":["",""],"id":4353}],[{"start":{"row":82,"column":0},"end":{"row":142,"column":3},"action":"insert","lines":["router.get('/likepost/:author/:id/:return/:group', ensureAuthenticated, function(req, res, next) {","    ","    User.findById(req.user.id, function(err, doc){","        console.log(doc);","        var nid = req.params.id.toString()","        var nlikes = doc.likes.toString();","        var test = nlikes.indexOf(nid);","        console.log(test);","        if (test<0){","        doc.likes.push({ keys: req.params.id.toString()});","        doc.save();","        ","        Post.findOne({ _id: req.params.id }, function (err, docs){","            docs.likes=docs.likes+1;","            if (docs.likes<=-1){","                 docs.color=\"red\";","            } else {","                docs.color=\"blacK\";","            }","            docs.save();","            if (err) throw err;","        User.findOne({username:docs.author}, function(err, doc) {","        if (err) return next(err);","       doc.notamount=doc.notamount+1;","       doc.notifications.unshift({from: req.user.username, type: \"like\", redirect:req.params.id, mini:marked(docs.content)});","       doc.save();","    });","        });","        if (req.params.return==\"home\"){","        res.redirect('/');","        };","        if (req.params.return==\"cookie\"){","        res.redirect('/cookie/'+req.params.id);","        };","        if (req.params.return==\"group\"){","        res.redirect('/group/'+req.params.group);","        };","        if (req.params.return==\"user\"){","            res.redirect('/user/'+req.params.author);","        }","        console.log(\"done!\");","        ","        } else if (test>0) {","            console.log(\"cant like again!\");","                    if (req.params.return==\"home\"){","        res.redirect('/');","        };","        if (req.params.return==\"cookie\"){","        res.redirect('/cookie/'+req.params.id);","        };","        if (req.params.return==\"group\"){","        res.redirect('/group/'+req.params.group);","        };","        if (req.params.return==\"user\"){","            res.redirect('/user/'+req.params.author);","        }","            ","        }","        if (err) throw err;","});","});"],"id":4354}],[{"start":{"row":125,"column":0},"end":{"row":141,"column":3},"action":"remove","lines":["            console.log(\"cant like again!\");","                    if (req.params.return==\"home\"){","        res.redirect('/');","        };","        if (req.params.return==\"cookie\"){","        res.redirect('/cookie/'+req.params.id);","        };","        if (req.params.return==\"group\"){","        res.redirect('/group/'+req.params.group);","        };","        if (req.params.return==\"user\"){","            res.redirect('/user/'+req.params.author);","        }","            ","        }","        if (err) throw err;","});"],"id":4355}],[{"start":{"row":109,"column":3},"end":{"row":121,"column":9},"action":"remove","lines":["     });","        if (req.params.return==\"home\"){","        res.redirect('/');","        };","        if (req.params.return==\"cookie\"){","        res.redirect('/cookie/'+req.params.id);","        };","        if (req.params.return==\"group\"){","        res.redirect('/group/'+req.params.group);","        };","        if (req.params.return==\"user\"){","            res.redirect('/user/'+req.params.author);","        }"],"id":4356}],[{"start":{"row":114,"column":3},"end":{"row":115,"column":0},"action":"insert","lines":["",""],"id":4357}],[{"start":{"row":115,"column":0},"end":{"row":115,"column":1},"action":"insert","lines":[")"],"id":4358}],[{"start":{"row":115,"column":0},"end":{"row":115,"column":1},"action":"remove","lines":[")"],"id":4359}],[{"start":{"row":115,"column":0},"end":{"row":115,"column":1},"action":"insert","lines":["}"],"id":4360}],[{"start":{"row":115,"column":1},"end":{"row":115,"column":2},"action":"insert","lines":[")"],"id":4361}],[{"start":{"row":115,"column":2},"end":{"row":115,"column":3},"action":"insert","lines":[";"],"id":4362}],[{"start":{"row":113,"column":0},"end":{"row":114,"column":0},"action":"insert","lines":["",""],"id":4363}],[{"start":{"row":114,"column":0},"end":{"row":114,"column":1},"action":"insert","lines":["}"],"id":4364}],[{"start":{"row":114,"column":1},"end":{"row":114,"column":2},"action":"insert","lines":[")"],"id":4365}],[{"start":{"row":114,"column":2},"end":{"row":114,"column":3},"action":"insert","lines":[";"],"id":4366}],[{"start":{"row":114,"column":2},"end":{"row":114,"column":3},"action":"remove","lines":[";"],"id":4367}],[{"start":{"row":114,"column":1},"end":{"row":114,"column":2},"action":"remove","lines":[")"],"id":4368}],[{"start":{"row":108,"column":7},"end":{"row":109,"column":0},"action":"insert","lines":["",""],"id":4369},{"start":{"row":109,"column":0},"end":{"row":109,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":109,"column":4},"end":{"row":109,"column":5},"action":"insert","lines":[")"],"id":4370}],[{"start":{"row":109,"column":4},"end":{"row":109,"column":5},"action":"remove","lines":[")"],"id":4371}],[{"start":{"row":109,"column":4},"end":{"row":109,"column":5},"action":"insert","lines":["}"],"id":4372},{"start":{"row":109,"column":0},"end":{"row":109,"column":4},"action":"remove","lines":["    "]},{"start":{"row":109,"column":0},"end":{"row":109,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":109,"column":9},"end":{"row":109,"column":10},"action":"insert","lines":[")"],"id":4373}],[{"start":{"row":109,"column":10},"end":{"row":109,"column":11},"action":"insert","lines":[";"],"id":4374}],[{"start":{"row":82,"column":20},"end":{"row":82,"column":21},"action":"remove","lines":["t"],"id":4375}],[{"start":{"row":82,"column":19},"end":{"row":82,"column":20},"action":"remove","lines":["s"],"id":4376}],[{"start":{"row":82,"column":18},"end":{"row":82,"column":19},"action":"remove","lines":["o"],"id":4377}],[{"start":{"row":82,"column":17},"end":{"row":82,"column":18},"action":"remove","lines":["p"],"id":4378}],[{"start":{"row":82,"column":17},"end":{"row":82,"column":18},"action":"insert","lines":["c"],"id":4379}],[{"start":{"row":82,"column":18},"end":{"row":82,"column":19},"action":"insert","lines":["o"],"id":4380}],[{"start":{"row":82,"column":19},"end":{"row":82,"column":20},"action":"insert","lines":["m"],"id":4381}],[{"start":{"row":82,"column":20},"end":{"row":82,"column":21},"action":"insert","lines":["m"],"id":4382}],[{"start":{"row":82,"column":21},"end":{"row":82,"column":22},"action":"insert","lines":["e"],"id":4383}],[{"start":{"row":82,"column":22},"end":{"row":82,"column":23},"action":"insert","lines":["n"],"id":4384}],[{"start":{"row":82,"column":23},"end":{"row":82,"column":24},"action":"insert","lines":["t"],"id":4385}],[{"start":{"row":82,"column":31},"end":{"row":82,"column":32},"action":"remove","lines":["r"],"id":4386}],[{"start":{"row":82,"column":30},"end":{"row":82,"column":31},"action":"remove","lines":["o"],"id":4387}],[{"start":{"row":82,"column":29},"end":{"row":82,"column":30},"action":"remove","lines":["h"],"id":4388}],[{"start":{"row":82,"column":28},"end":{"row":82,"column":29},"action":"remove","lines":["t"],"id":4389}],[{"start":{"row":82,"column":27},"end":{"row":82,"column":28},"action":"remove","lines":["u"],"id":4390}],[{"start":{"row":82,"column":26},"end":{"row":82,"column":27},"action":"remove","lines":["a"],"id":4391}],[{"start":{"row":82,"column":26},"end":{"row":82,"column":27},"action":"insert","lines":["r"],"id":4392}],[{"start":{"row":82,"column":27},"end":{"row":82,"column":28},"action":"insert","lines":["o"],"id":4393}],[{"start":{"row":82,"column":28},"end":{"row":82,"column":29},"action":"insert","lines":["o"],"id":4394}],[{"start":{"row":82,"column":29},"end":{"row":82,"column":30},"action":"insert","lines":["t"],"id":4395}],[{"start":{"row":94,"column":40},"end":{"row":94,"column":41},"action":"remove","lines":["d"],"id":4396}],[{"start":{"row":94,"column":39},"end":{"row":94,"column":40},"action":"remove","lines":["i"],"id":4397}],[{"start":{"row":94,"column":39},"end":{"row":94,"column":40},"action":"insert","lines":["r"],"id":4398}],[{"start":{"row":94,"column":40},"end":{"row":94,"column":41},"action":"insert","lines":["o"],"id":4399}],[{"start":{"row":94,"column":41},"end":{"row":94,"column":42},"action":"insert","lines":["o"],"id":4400}],[{"start":{"row":94,"column":42},"end":{"row":94,"column":43},"action":"insert","lines":["t"],"id":4401}],[{"start":{"row":91,"column":43},"end":{"row":91,"column":44},"action":"remove","lines":["d"],"id":4402}],[{"start":{"row":91,"column":42},"end":{"row":91,"column":43},"action":"remove","lines":["i"],"id":4403}],[{"start":{"row":91,"column":42},"end":{"row":91,"column":43},"action":"insert","lines":["r"],"id":4404}],[{"start":{"row":91,"column":43},"end":{"row":91,"column":44},"action":"insert","lines":["o"],"id":4405}],[{"start":{"row":91,"column":44},"end":{"row":91,"column":45},"action":"insert","lines":["o"],"id":4406}],[{"start":{"row":91,"column":45},"end":{"row":91,"column":46},"action":"insert","lines":["t"],"id":4407}],[{"start":{"row":94,"column":23},"end":{"row":94,"column":24},"action":"remove","lines":["_"],"id":4408}],[{"start":{"row":94,"column":23},"end":{"row":94,"column":24},"action":"insert","lines":["c"],"id":4409}],[{"start":{"row":94,"column":24},"end":{"row":94,"column":25},"action":"insert","lines":["o"],"id":4410}],[{"start":{"row":94,"column":25},"end":{"row":94,"column":26},"action":"insert","lines":["m"],"id":4411}],[{"start":{"row":94,"column":26},"end":{"row":94,"column":27},"action":"insert","lines":["m"],"id":4412}],[{"start":{"row":94,"column":27},"end":{"row":94,"column":28},"action":"insert","lines":["e"],"id":4413}],[{"start":{"row":94,"column":28},"end":{"row":94,"column":29},"action":"insert","lines":["n"],"id":4414}],[{"start":{"row":94,"column":29},"end":{"row":94,"column":30},"action":"insert","lines":["t"],"id":4415}],[{"start":{"row":94,"column":30},"end":{"row":94,"column":31},"action":"insert","lines":["s"],"id":4416}],[{"start":{"row":94,"column":31},"end":{"row":94,"column":32},"action":"insert","lines":["l"],"id":4417}],[{"start":{"row":94,"column":32},"end":{"row":94,"column":33},"action":"insert","lines":["i"],"id":4418}],[{"start":{"row":94,"column":33},"end":{"row":94,"column":34},"action":"insert","lines":["s"],"id":4419}],[{"start":{"row":94,"column":34},"end":{"row":94,"column":35},"action":"insert","lines":["t"],"id":4420}],[{"start":{"row":94,"column":35},"end":{"row":94,"column":36},"action":"insert","lines":["."],"id":4421}],[{"start":{"row":94,"column":35},"end":{"row":94,"column":36},"action":"remove","lines":["."],"id":4422}],[{"start":{"row":94,"column":34},"end":{"row":94,"column":35},"action":"remove","lines":["t"],"id":4423}],[{"start":{"row":94,"column":33},"end":{"row":94,"column":34},"action":"remove","lines":["s"],"id":4424}],[{"start":{"row":94,"column":32},"end":{"row":94,"column":33},"action":"remove","lines":["i"],"id":4425}],[{"start":{"row":94,"column":31},"end":{"row":94,"column":32},"action":"remove","lines":["l"],"id":4426}],[{"start":{"row":94,"column":30},"end":{"row":94,"column":31},"action":"remove","lines":["s"],"id":4427}],[{"start":{"row":94,"column":29},"end":{"row":94,"column":30},"action":"remove","lines":["t"],"id":4428}],[{"start":{"row":94,"column":28},"end":{"row":94,"column":29},"action":"remove","lines":["n"],"id":4429}],[{"start":{"row":94,"column":27},"end":{"row":94,"column":28},"action":"remove","lines":["e"],"id":4430}],[{"start":{"row":94,"column":26},"end":{"row":94,"column":27},"action":"remove","lines":["m"],"id":4431}],[{"start":{"row":94,"column":25},"end":{"row":94,"column":26},"action":"remove","lines":["m"],"id":4432}],[{"start":{"row":94,"column":24},"end":{"row":94,"column":25},"action":"remove","lines":["o"],"id":4433}],[{"start":{"row":94,"column":23},"end":{"row":94,"column":24},"action":"remove","lines":["c"],"id":4434}],[{"start":{"row":94,"column":23},"end":{"row":94,"column":24},"action":"insert","lines":["_"],"id":4435}],[{"start":{"row":94,"column":42},"end":{"row":94,"column":43},"action":"remove","lines":["t"],"id":4436}],[{"start":{"row":94,"column":41},"end":{"row":94,"column":42},"action":"remove","lines":["o"],"id":4437}],[{"start":{"row":94,"column":40},"end":{"row":94,"column":41},"action":"remove","lines":["o"],"id":4438}],[{"start":{"row":94,"column":39},"end":{"row":94,"column":40},"action":"remove","lines":["r"],"id":4439}],[{"start":{"row":94,"column":39},"end":{"row":94,"column":40},"action":"insert","lines":["i"],"id":4440}],[{"start":{"row":94,"column":40},"end":{"row":94,"column":41},"action":"insert","lines":["d"],"id":4441}],[{"start":{"row":81,"column":18},"end":{"row":81,"column":19},"action":"insert","lines":["/"],"id":4442}],[{"start":{"row":81,"column":19},"end":{"row":81,"column":20},"action":"insert","lines":["*"],"id":4443}],[{"start":{"row":117,"column":3},"end":{"row":117,"column":4},"action":"insert","lines":["*"],"id":4444}],[{"start":{"row":117,"column":4},"end":{"row":117,"column":5},"action":"insert","lines":["/"],"id":4445}]]},"ace":{"folds":[],"scrolltop":1406,"scrollleft":0,"selection":{"start":{"row":117,"column":5},"end":{"row":117,"column":5},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":62,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1456708084976,"hash":"c463cc373ffa1aae3b77e9d32664dadab8e5875c"}